components:
  schemas:
    Chaos:
      type: object
      description: "Configuration of chaos experiments"
      properties:
        background_traffic:
          $ref: "#/components/schemas/Chaos.BackgroundTraffic"
        drop_frames:
          $ref: "#/components/schemas/Chaos.DropFrames"
            
    Chaos.BackgroundTraffic:
      type: object
      properties:
        flows:
          type: array
          items:
            $ref: "#/components/schemas/Chaos.BackgroundTraffic.Flow"

    Chaos.BackgroundTraffic.Flow:
      type: object
      properties:
        name:
          type: string
        fabric_entry_point:
          $ref: "#/components/schemas/Chaos.BackgroundTraffic.Flow.EntryPoint"
        choice:
          type: string
          enum: [stateless]
        stateless:
          type: array
          items:
            $ref: "#/components/schemas/Chaos.BackgroundTraffic.Flow.Stateless"

    Chaos.BackgroundTraffic.Flow.EntryPoint:
      type: object
      properties:
        choice:
          type: string
          enum: [switch_reference, front_panel_port]
        switch_reference:
          $ref: "#/components/schemas/Chaos.BackgroundTraffic.Flow.EntryPoint.SwitchReference"
        front_panel_port:
          $ref: "#/components/schemas/Chaos.BackgroundTraffic.Flow.EntryPoint.FrontPanelPort"

    Chaos.BackgroundTraffic.Flow.EntryPoint.SwitchReference:
      type: object
      properties:
        choice:
          type: string
          enum: [spine, pod, tor]
        spine:
          $ref: "#/components/schemas/Chaos.BackgroundTraffic.Flow.EntryPoint.SwitchReference.Spine"
        pod:
          $ref: "#/components/schemas/Chaos.BackgroundTraffic.Flow.EntryPoint.SwitchReference.PodSwitchReference"
        tor:
          $ref: "#/components/schemas/Chaos.BackgroundTraffic.Flow.EntryPoint.SwitchReference.PodSwitchReference"

    Chaos.BackgroundTraffic.Flow.EntryPoint.SwitchReference.Spine:
      type: object
      properties:
        switch_index: 
          type: integer

    Chaos.BackgroundTraffic.Flow.EntryPoint.SwitchReference.PodSwitchReference:
      type: object
      properties:
        pod_index:
          type: integer
        switch_index:
          type: integer

    Chaos.BackgroundTraffic.Flow.EntryPoint.FrontPanelPort:
      type: object
      properties:
        front_panel_port:
          type: integer
          description: Front panel port number (if fabric is emulated on a device with front panel ports)

    Chaos.BackgroundTraffic.Flow.Stateless:
      type: object
      properties:
        name:
          type: string
        rate:
          type: integer
        rate_unit: 
          type: string
          enum: [bps, Kbps, Mbps, Gbps]
        packet:
          $ref: "#/components/schemas/Chaos.BackgroundTraffic.Flow.Stateless.Packet"

    Chaos.BackgroundTraffic.Flow.Stateless.Packet:
      type: object
      properties:
        src_address:
          description: source IP address
          type: string
        dst_address:
          description: destination IP address
          type: string
        src_port:
          type: integer
          description: Layer 4 source port
          maximum: 65535
          default: 1024
        dst_port:
          type: integer
          description: Layer 4 destination port
          maximum: 65535
          default: 1024
        size:
          type: integer
          description: total packet size
          minimum: 64
          default: 1000
        l4_protocol:
          type: string
          description: Layer 4 transport protocol
          enum: [tcp, udp]


    Chaos.DropFrames:
      type: object
      description: Configures the percentage of time during a 1 second period during which frames are dropped on selected links
      properties:
        configs:
          type: array
          items:
            $ref: "#/components/schemas/Chaos.DropFrames.Config"

    Chaos.DropFrames.Config:
      type: object
      description: Configures the percentage of time during a 1 second period during which frames are dropped on a link
      properties:
        name:
          type: string
          description: Uniquely identifies a config entry
        link:
          type: string
          description: Emulated link name, e.g. Link S.1/2
        type:
          type: string
          description: Means to express the interval in which frames are dropped, either as a percentage or min possible time
          enum: [percentage_time, min_time]
        percentage:
          type: number
          description: "Percentage value, ignored if type is min_time"